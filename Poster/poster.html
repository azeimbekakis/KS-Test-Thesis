<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">


<!--
Font-awesome icons ie github or twitter
-->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/brands.css" integrity="sha384-n9+6/aSqa9lBidZMRCQHTHKJscPq6NW4pCQBiMmHdUCvPN8ZOg2zJJTkC7WIezWv" crossorigin="anonymous">

<!--
Google fonts api stuff
-->



<title>Survey of Misuses of the Kolmogorov-Smirnov Test</title>

<script src="poster_files/header-attrs-2.11/header-attrs.js"></script>





<style>
@page {
size: 48in 30in;
margin: 0;
padding: 0;
}
body {
margin: 0;
font-size: 30pt;
width: 48in;
height: 30in;
padding: 0;
text-align: justify;
font-family: Palatino;
}
.poster_wrap {
width: 48in;
height: 30in;
padding: 0cm;
}
.title_container {
width: 48in;
height: calc(30in * 0.15);
overflow: hidden;
background-color: #000E2F;
border: 0 solid #FFFFFF;
}
.logo_left {
float: left;
width: 10%;
height: 100%;
background-color: #000E2F;
display: flex;
align-items: center;
justify-content: center;
}
.logo_right {
float: right;
width: 10%;
height: 100%;
background-color: #000E2F;
display: flex;
align-items: center;
justify-content: center;
}
.poster_title {
text-align: center;
position: relative;
float: left;
width: 80%;
height: 100%;
color: #FFFFFF;
top: 50%;
transform: translateY(-50%);
-webkit-transform: translateY(-50%);
}
#title {
font-family: Palatino;
}
/* unvisited link */
a:link {
color: #cc0000;
}
.mybreak {
  break-before: column;
}
/* visited link */
a:visited {
color: #cc0000;
}

/* mouse over link */
a:hover {
color: #cc0000;
}

/* selected link */
a:active {
color: #cc0000;
}
.poster_body {
-webkit-column-count: 4; /* Chrome, Safari, Opera */
-moz-column-count: 4; /* Firefox */
column-count: 4;
-webkit-column-fill: auto;
-moz-column-fill: auto;
column-fill: auto;
-webkit-column-rule-width: 1mm;
-moz-column-rule-width: 1mm;
column-rule-width: 1mm;
-webkit-column-rule-style: dashed;
-moz-column-rule-style: dashed;
column-rule-style: dashed;
-webkit-column-rule-color: #000E2F;
-moz-column-rule-color: #000E2F;
column-rule-color: #000E2F;
column-gap: 1em;
padding-left: 0.5em;
padding-right: 0.5em;
height: 100%;
color: #000000
background-color: #ffffff;
}
.poster_title h1 {
font-size: 75pt;
margin: 0;
border: 0;
font-weight: normal;
}
.poster_body_wrap{
width: calc(48in + 0 + 0);
height: calc(30in * 0.83);
padding-top: calc(30in * 0.005);
padding-bottom: calc(30in * 0.01);
background-color: #ffffff;
}
.poster_title h3 {
color: #FFFFFF;
font-size: 50pt;
margin: 0;
border: 0;
font-weight: normal;
}
.poster_title h3 > sup {
  font-size: 35pt;
  margin-left: 0.02em;
}
.poster_title h5 {
color: #FFFFFF;
font-size: 35pt;
margin: 0;
border: 0;
font-weight: normal;
}
img {
margin-top: 2cm;
margin-bottom: 0;
}
.section {
  padding: 0.2em;
}
.poster_body h1 {
text-align: center;
color: #FFFFFF;
font-size: 50pt;
border: 2mm solid #000E2F;
background-color: #000E2F;
border-radius: 4mm 0mm;
margin-top: 2mm;
margin-bottom: 2mm;
font-weight: normal;
}
.poster_body h2 {
color: #000E2F;
font-size: 40pt;
padding-left: 4mm;
font-weight: normal;
}
.span {
width: 200%;
}
/* center align leaflet map,
from https://stackoverflow.com/questions/52112119/center-leaflet-in-a-rmarkdown-document */
.html-widget {
margin: auto;
position: sticky;
margin-top: 2cm;
margin-bottom: 2cm;
}
.leaflet.html-widget.html-widget-static-bound.leaflet-container.leaflet-touch.leaflet-fade-anim.leaflet-grab.leaflet-touch-drag.leaflet-touch-zoom {
position: sticky;
width: 100%;
}
pre.sourceCode.r {
background-color: #dddddd40;
border-radius: 4mm;
padding: 4mm;
width: 75%;
/* align-items: center; */
margin: auto;
padding-left: 2cm;
}
code.sourceCode.r{
background-color: transparent;
font-size: 20pt;
border-radius: 2mm;
}
.caption {
font-size: 25pt;
}
.table caption {
font-size: 25pt;
padding-bottom: 3mm;

}
code {
font-size: 1em;
font-family: monospace;
background-color: #FFFFFF24;
color: #000E2F;
padding: 1.2mm;
border-radius: 2mm;
}
.poster_title code {
font-size: 1em;
}
table {
font-size: 40px;
margin: auto;
border-top: 3px solid #666;
border-bottom: 3px solid #666;
}
table thead th {
border-bottom: 3px solid #ddd;
}
td {
padding: 8px;
}
th {
padding: 15px;
}
caption {
margin-bottom: 10px;
}
.poster_body p {
margin-right: 4mm;
margin-left: 4mm;
margin-top: 6mm;
margin-bottom: 10mm;
}
.poster_body ol {
margin-right: 4mm;
margin-left: 4mm;
}
#ul {
margin-right: 4mm;
margin-left: 4mm;
}
.references p {
font-size: 20pt;
}
.orcid img {
  width: 1em;
}
</style>
</head>
<body>


<div class="poster_wrap">
<div class="title_container">
<!-- Left Logo  -->
<div class="logo_left">
<img src= 'uconn-wordmark-single-white.png' style="width: 80%">
</div>
<!-- Poster Title -->
<div class= "poster_title">
<h1 id="title">Survey of Misuses of the Kolmogorov-Smirnov Test</h1>
<h3 id="author">Anthony Zeimbekakis<sup>1</sup>, Jun Yan<sup>1</sup></h3><br>
<h5 id="affiliation"><sup>1</sup> Department of Statistics, University of Connecticut</h5>
</div>
<!-- Right Logo  -->
<div class="logo_right">
<img src=uconn-wordmark-single-white.png style="width: 80%">
</div>
</div>

<div class='poster_body_wrap'>
<div class='poster_body'>
<style type="text/css">
#title {
  padding-top: 1.5cm;
  padding-bottom: 1.5cm;
}

.title_container {
  height: calc(38in * 0.13);
}

img {
  margin-top: 0cm;
}
</style>
<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>The Kolmogorov-Smirnov (K-S) test is one the most popular goodness-of-fit tests for
comparing a sample with a hypothesized parametric distribution:</p>
<ul>
<li>Given a sample of n observations, let <span class="math inline">\(S_{n}(x)\)</span> be the empirical
cumulative distribution and <span class="math inline">\(F(x)\)</span> be the population cumulative distribution</li>
<li>The K-S statistic is defined by: <span class="math display">\[d = max(\lvert F(x)-S_{n}(x) \rvert)\]</span></li>
<li><span class="math inline">\(H_0=\)</span> The data follows a specified distribution <span class="math inline">\(F(x)\)</span></li>
<li><span class="math inline">\(H_A=\)</span> The data does not follow a specified distribution <span class="math inline">\(F(x)\)</span></li>
<li>If the value of <span class="math inline">\(d\)</span> exceeds the test’s corresponding critical value,
the null hypothesis is rejected</li>
</ul>
<p>The standard one-sample KS test applies to <strong>independent, continuous data with a hypothesized distribution that
is completely specified</strong>, though it’s often used incorrectly. We aim to survey misuses of the K-S test,
demonstrate their consequences through simulation, and
provide remedies as needed.</p>
<ul>
<li>All simulations unless specified are performed with the standard normal distribution <span class="math inline">\(N(0,1)\)</span></li>
</ul>
</div>
<div id="fitted-parameters" class="section level1">
<h1>2. Fitted Parameters</h1>
<div id="assumption" class="section level2">
<h2>2.1. Assumption:</h2>
<ul>
<li>Hypothesized distribution <span class="math inline">\(F(x)\)</span> is completely specified</li>
</ul>
</div>
<div id="misuse" class="section level2">
<h2>2.2. Misuse:</h2>
<ul>
<li>Hypothesized distribution <span class="math inline">\(F(x)\)</span> is fitted with parameters from the sample</li>
</ul>
<p>Ex: For the normal distribution, the test is performed where <span class="math inline">\(F(x)\)</span> ~ <span class="math inline">\(N(\bar{X}, s^2)\)</span> <span class="citation">(Lilliefors 1967)</span>.</p>
</div>
<div id="remedy" class="section level2">
<h2>2.3. Remedy:</h2>
<p>A remedy for this issue is to use bootstrap, detailed by <span class="citation">(Genest and Rémillard 2008)</span> and <span class="citation">(Babu and Rao 2004)</span>:</p>
<ul>
<li><span class="math inline">\(d_0\)</span> is the observed K-S statistic</li>
<li>Let <span class="math inline">\(X_1^*,...,X_n^*\)</span> be i.i.d random variables from <span class="math inline">\(\hat{S}_n\)</span>, an estimator of the empirical distribution function <span class="math inline">\(S\)</span> based on the sample <span class="math inline">\(X_1,...,X_n\)</span></li>
<li>Let <span class="math inline">\(\hat{\theta}_n^* = \theta_n(X_1^*,...,X_n^*)\)</span>. <span class="math inline">\(\theta\)</span> represent the sample mean and variance of the bootstrap sample <span class="math inline">\(X_1^*,...,X_n^*\)</span></li>
<li>New K-S statistic: <span class="math inline">\(d = max(\lvert F(x)-S_{n}(x;\hat{\theta}_n^*) \rvert)\)</span></li>
<li>Count the number of bootstrap K-S statistics greater than or equal to <span class="math inline">\(d_0\)</span>, and divide by the number of
bootstrap samples to calculate p-value</li>
</ul>
</div>
<div id="results" class="section level2">
<h2>2.4. Results:</h2>
<p><image width="100%" src="../Manuscript/hist_fitted.pdf"/></p>
<ul>
<li><p>Naive plot was performed with <span class="math inline">\(F(x)\)</span> ~ <span class="math inline">\(N(\bar{X}, s^2)\)</span></p></li>
<li><p>Parametric plot was performed with <span class="math inline">\(\hat{S}_n = F(.;\hat{\theta}_n)\)</span></p></li>
<li><p>Babu plot was performed with <span class="math inline">\(\hat{S}_n = S_n\)</span> and a correction for bias from <span class="citation">(Babu and Rao 2004)</span></p></li>
</ul>
<p>With replicate tests, the distribution of p-values is <span class="math inline">\(U(0,1)\)</span>.
However since the assumption of a specified distribution is violated, the naive plot too
often does not reject the null hypothesis. Bootstrap restores the power of the test.</p>
</div>
</div>
<div id="temporal-dependence" class="section level1">
<h1>3. Temporal Dependence</h1>
<div id="assumption-1" class="section level2">
<h2>3.1 Assumption:</h2>
<ul>
<li>The empirical distribution <span class="math inline">\(S_{n}(x)\)</span> contains independent data</li>
</ul>
</div>
<div id="misues" class="section level2">
<h2>3.2 Misues:</h2>
<ul>
<li>The empirical distribution <span class="math inline">\(S_{n}(x)\)</span> contains dependent data</li>
</ul>
<p>To demonstrate this, data is simulated from an <span class="math inline">\(AR(1)\)</span> process with <span class="math inline">\(AR = (-3, 3)\)</span>.
There is an inverse relationship between negative and positive <span class="math inline">\(AR\)</span> values <span class="citation">(Durilleul and Legendre 1992)</span>, and the
distributions are not uniform when temporal dependence is present.</p>
<p><image width="100%" src="../Manuscript/hist_correlation.pdf"/></p>
</div>
<div id="remedy-1" class="section level2">
<h2>3.3 Remedy:</h2>
<ul>
<li>Use copulas combined with bootstrap, for two reasons</li>
</ul>
<ol style="list-style-type: decimal">
<li>Ensure that the marginal distribution of our bootstrap data is the same as the fitted distribution</li>
<li>Introduce temporal dependence at the same level as the fitted distribution
The procedure used is the same as bootstrap, except the re-sampling comes from correlated data generated by
copulas</li>
</ol>
</div>
<div id="results-1" class="section level2">
<h2>3.4 Results:</h2>
<p><image width="100%" src="../Manuscript/hist_copula_only.pdf"/></p>
<ul>
<li>The copula remedy restores the <span class="math inline">\(U(0,1)\)</span> nature of the p-values</li>
</ul>
</div>
</div>
<div id="fitted-parameters-temporal-dependence" class="section level1">
<h1>4. Fitted Parameters + Temporal Dependence</h1>
<p>If both assumptions are violated, the copula fix works as well.</p>
<p><image width="100%" src="../Manuscript/hist_copula.pdf"/></p>
<ul>
<li>First plot shows the distribution of p-values when performing the copula remedy</li>
<li>Second plot shows the distribution of p-values when performing basic parametric bootstrap,
which naively ignores dependence</li>
<li>Third plot shows the violation of both assumptions,
where fitted parameters are used and dependence is not considered</li>
</ul>
</div>
<div id="conclusion" class="section level1">
<h1>5. Conclusion</h1>
<ul>
<li><p>When the K-S test is used with violated assumptions, it no longer holds it’s power
and corrections must be made</p></li>
<li><p>In the case of fitted parameters, parametric and non-parametric bootstrap are recommended solutions</p></li>
<li><p>When there is dependence in the data, performing bootstrap with copulas is recommended.</p></li>
<li><p>When both assumptions are violated, meaning there is dependent data and parameters must be estimated,
perform bootstrap with copulas</p></li>
<li><p>If the guess isn’t far from the true distribution it may still be reasonably accurate for other distributions.</p></li>
</ul>
</div>
<div id="references" class="section level1 unnumbered">
<h1>6. References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Babu" class="csl-entry">
Babu, Gutti Jogesh, and C. R. Rao. 2004. <span>“Goodness-of-Fit Tests When Parameters Are Estimated.”</span> <em>Sankhya: The Indian Journal of Statistics</em> 66: 63–74.
</div>
<div id="ref-Durilleul" class="csl-entry">
Durilleul, Pierre, and Pierre Legendre. 1992. <span>“Lack of Robustness in Two Tests of Normality Against Autocorrelation in Sample Data.”</span> <em>Journal of Statistical Computation and Simulation</em> 42 (1-2): 79–91.
</div>
<div id="ref-Genest" class="csl-entry">
Genest, Christian, and Bruno Rémillard. 2008. <span>“<span class="nocase">Validity of the parametric bootstrap for goodness-of-fit testing in semiparametric models</span>.”</span> <em>Annales de l’Institut Henri Poincar<span>é</span>, Probabilit<span>é</span>s Et Statistiques</em> 44 (6): 1096–1127.
</div>
<div id="ref-Lilliefors" class="csl-entry">
Lilliefors, Hubert W. 1967. <span>“On the <span>K</span>olmogorov-<span>S</span>mirnov Test for Normality with Mean and Variance Unknown.”</span> <em>Journal of the American Statistical Association</em> 62 (318): 399–402.
</div>
</div>
</div>
</div>
</div>

</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
var script = document.createElement("script");
script.type = "text/javascript";
var src = "true";
if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
if (location.protocol !== "file:" && /^https?:/.test(src))
src = src.replace(/^https?:/, '');
script.src = src;
document.getElementsByTagName("head")[0].appendChild(script);
})();
</script>


</body>
</html>
